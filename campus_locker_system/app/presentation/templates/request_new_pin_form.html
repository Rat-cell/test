{% extends "base.html" %}

{% block title %}Request New PIN - Campus Locker System{% endblock %}

{% block header_title %}🔄 Request New PIN{% endblock %}

{% block content %}
<div class="card">
    <div class="text-center mb-6">
        <div class="icon">🔄</div>
        <h1>Request New PIN</h1>
        <p>Get a fresh PIN for your parcel pickup</p>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul class="flashes">
        {% for category, message in messages %}
          <li class="{{ category }}">{{ message }}</li>
        {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <div class="alert alert--info mb-6">
        <h3>📋 When to use this form</h3>
        <ul style="margin: 0; padding-left: 1.5rem;">
            <li><strong>Your PIN has expired</strong> (after {{ pin_expiry_hours }} hours)</li>
            <li><strong>You didn't receive your PIN email</strong></li>
            <li><strong>You need a fresh PIN</strong> for any reason</li>
            <li><strong>Your PIN generation link expired</strong> (email-based system)</li>
        </ul>
    </div>

    <form method="POST" action="">
        <div class="form-group">
            <label for="recipient_email">📧 Your Email Address</label>
            <input type="email" 
                   id="recipient_email" 
                   name="recipient_email" 
                   required 
                   placeholder="Enter the email address used for the parcel"
                   autocomplete="email">
        </div>
        
        <div class="form-group">
            <label for="locker_id">🔒 Locker ID</label>
            <input type="text" 
                   id="locker_id" 
                   name="locker_id" 
                   required 
                   placeholder="Enter the locker number (e.g., 1, 2, 3)"
                   pattern="[0-9]+"
                   title="Please enter a valid locker number">
        </div>
        
        <button type="submit" class="btn btn--primary btn--large btn--full">
            🔄 Request New PIN
        </button>
    </form>

    <div class="text-center mt-6 flex gap-4">
        <a href="/pickup" class="btn btn--secondary btn--full">
            ← Back to Pickup
        </a>
        <a href="/" class="btn btn--secondary btn--full">
            🏠 Home
        </a>
    </div>
</div>
{% endblock %}
